<div class="ladder-container">
  <div class="ladder-header">
    <div class="filter-group">
      <label for="sortSelect" class="filter-label">Sort by:</label>
      <select #sortSelect id="sortSelect" class="filter-select">
        <option value="achievementPoints">Achievement Points</option>
        <option value="honorableKills">Honorable Kills</option>
      </select>
    </div>
    
    <div class="filter-group">
      <label for="realmSelect" class="filter-label">Realm:</label>
      <select #realmSelect id="realmSelect" class="filter-select">
        <option value="">All Realms</option>
        <option value="Evermoon">Evermoon</option>
        <option value="Tauri">Tauri</option>
        <option value="WoD">WoD</option>
      </select>
    </div>

    <div class="filter-group">
      <label for="classSelect" class="filter-label">Class:</label>
      <div class="class-dropdown" [class.open]="classMenuOpen">
        <button type="button" class="filter-select class-trigger" (click)="toggleClassMenu()">
          <img *ngIf="selectedClassIcon" [src]="selectedClassIcon" alt="Selected class icon" class="option-icon" />
          <span *ngIf="!selectedClassIcon" class="option-icon placeholder"></span>
          <span class="option-label">{{ selectedClassLabel }}</span>
          <span class="chevron">â–¾</span>
        </button>
        <div class="class-menu">
          <button type="button" class="class-option" (click)="selectClass()">
            <span class="option-icon placeholder"></span>
            <span class="option-label">All Classes</span>
          </button>
          <button
            type="button"
            class="class-option"
            *ngFor="let cls of classOptions"
            (click)="selectClass(cls)">
            <img [src]="cls.icon" [alt]="cls.name + ' icon'" class="option-icon" />
            <span class="option-label">{{ cls.name }}</span>
          </button>
        </div>
      </div>
    </div>
    
    <div class="filter-group">
      <label for="factionSelect" class="filter-label">Faction:</label>
      <select #factionSelect id="factionSelect" class="filter-select">
        <option value="">All Factions</option>
        <option value="Horde">Horde</option>
        <option value="Alliance">Alliance</option>
      </select>
    </div>
    
    <button type="button" (click)="applyFilters(sortSelect, realmSelect, factionSelect)" class="filter-button">Filter</button>
  </div>

  <table class="wow-table">
    <thead>
      <tr>
        <th>#</th>
        <th>Name</th>
        <th>Race / Class</th>
        <th>Realm</th>
        <th>Guild</th>
        <th>Achievement points</th>
        <th>Honorable kills</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let player of players" [ngClass]="player.faction">
        <td>{{ player.rank }}</td>
        <td>
          <a 
            class="player-name clickable" 
            [href]="getArmoryUrl(player.name, player.realm)"
            target="_blank"
            rel="noopener noreferrer"
            [title]="'Open ' + player.name + ' armory'">
            {{ player.name }}
          </a>
        </td>
        <td>
          <img 
            [src]="player.raceIcon"
            [alt]="'Race ' + player.race + '-' + player.gender"
            class="icon race-icon"
            loading="lazy"
            (error)="onImageError($event)"
          />
          <img 
            [src]="getClassIconPath(player.classIcon)" 
            [alt]="'Class ' + player.classIcon"
            class="icon class-icon"
            loading="lazy"
            (error)="onImageError($event)"
          />
        </td>
        <td>{{ player.realm }}</td>
        <td>
          <a 
            *ngIf="player.guild"
            class="guild-name clickable" 
            [href]="getGuildArmoryUrl(player.guild, player.realm)"
            target="_blank"
            rel="noopener noreferrer"
            [title]="'Open ' + player.guild + ' guild page'">
            {{ player.guild }}
          </a>
        </td>
        <td class="gold-text">{{ player.achievementPoints | number }}</td>
        <td>{{ player.honorableKills | number }}</td>
      </tr>
    </tbody>
  </table>
</div>
